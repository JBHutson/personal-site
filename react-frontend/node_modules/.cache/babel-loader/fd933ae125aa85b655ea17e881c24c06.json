{"ast":null,"code":"import _toConsumableArray from \"/Users/jameshutson/Code/jameshutson_v2.0/personal-site/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"/Users/jameshutson/Code/jameshutson_v2.0/personal-site/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/jameshutson/Code/jameshutson_v2.0/personal-site/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport Duration from \"../duration.js\";\n\nfunction dayDiff(earlier, later) {\n  var utcDayStart = function utcDayStart(dt) {\n    return dt.toUTC(0, {\n      keepLocalTime: true\n    }).startOf(\"day\").valueOf();\n  },\n      ms = utcDayStart(later) - utcDayStart(earlier);\n\n  return Math.floor(Duration.fromMillis(ms).as(\"days\"));\n}\n\nfunction highOrderDiffs(cursor, later, units) {\n  var differs = [[\"years\", function (a, b) {\n    return b.year - a.year;\n  }], [\"months\", function (a, b) {\n    return b.month - a.month + (b.year - a.year) * 12;\n  }], [\"weeks\", function (a, b) {\n    var days = dayDiff(a, b);\n    return (days - days % 7) / 7;\n  }], [\"days\", dayDiff]];\n  var results = {};\n  var lowestOrder, highWater;\n\n  for (var _i = 0, _differs = differs; _i < _differs.length; _i++) {\n    var _differs$_i = _slicedToArray(_differs[_i], 2),\n        unit = _differs$_i[0],\n        differ = _differs$_i[1];\n\n    if (units.indexOf(unit) >= 0) {\n      lowestOrder = unit;\n      var delta = differ(cursor, later);\n      highWater = cursor.plus(_defineProperty({}, unit, delta));\n\n      if (highWater > later) {\n        cursor = cursor.plus(_defineProperty({}, unit, delta - 1));\n        delta -= 1;\n      } else {\n        cursor = highWater;\n      }\n\n      results[unit] = delta;\n    }\n  }\n\n  return [cursor, results, highWater, lowestOrder];\n}\n\nexport default function (earlier, later, units, opts) {\n  var _highOrderDiffs = highOrderDiffs(earlier, later, units),\n      _highOrderDiffs2 = _slicedToArray(_highOrderDiffs, 4),\n      cursor = _highOrderDiffs2[0],\n      results = _highOrderDiffs2[1],\n      highWater = _highOrderDiffs2[2],\n      lowestOrder = _highOrderDiffs2[3];\n\n  var remainingMillis = later - cursor;\n  var lowerOrderUnits = units.filter(function (u) {\n    return [\"hours\", \"minutes\", \"seconds\", \"milliseconds\"].indexOf(u) >= 0;\n  });\n\n  if (lowerOrderUnits.length === 0) {\n    if (highWater < later) {\n      highWater = cursor.plus(_defineProperty({}, lowestOrder, 1));\n    }\n\n    if (highWater !== cursor) {\n      results[lowestOrder] = (results[lowestOrder] || 0) + remainingMillis / (highWater - cursor);\n    }\n  }\n\n  var duration = Duration.fromObject(Object.assign(results, opts));\n\n  if (lowerOrderUnits.length > 0) {\n    var _Duration$fromMillis;\n\n    return (_Duration$fromMillis = Duration.fromMillis(remainingMillis, opts)).shiftTo.apply(_Duration$fromMillis, _toConsumableArray(lowerOrderUnits)).plus(duration);\n  } else {\n    return duration;\n  }\n}","map":{"version":3,"sources":["/Users/jameshutson/Code/jameshutson_v2.0/personal-site/react-frontend/node_modules/luxon/src/impl/diff.js"],"names":["Duration","dayDiff","earlier","later","utcDayStart","dt","toUTC","keepLocalTime","startOf","valueOf","ms","Math","floor","fromMillis","as","highOrderDiffs","cursor","units","differs","a","b","year","month","days","results","lowestOrder","highWater","unit","differ","indexOf","delta","plus","opts","remainingMillis","lowerOrderUnits","filter","u","length","duration","fromObject","Object","assign","shiftTo"],"mappings":"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","sourcesContent":["import Duration from \"../duration.js\";\n\nfunction dayDiff(earlier, later) {\n  const utcDayStart = dt =>\n      dt\n        .toUTC(0, { keepLocalTime: true })\n        .startOf(\"day\")\n        .valueOf(),\n    ms = utcDayStart(later) - utcDayStart(earlier);\n  return Math.floor(Duration.fromMillis(ms).as(\"days\"));\n}\n\nfunction highOrderDiffs(cursor, later, units) {\n  const differs = [\n    [\"years\", (a, b) => b.year - a.year],\n    [\"months\", (a, b) => b.month - a.month + (b.year - a.year) * 12],\n    [\n      \"weeks\",\n      (a, b) => {\n        const days = dayDiff(a, b);\n        return (days - (days % 7)) / 7;\n      }\n    ],\n    [\"days\", dayDiff]\n  ];\n\n  const results = {};\n  let lowestOrder, highWater;\n\n  for (const [unit, differ] of differs) {\n    if (units.indexOf(unit) >= 0) {\n      lowestOrder = unit;\n\n      let delta = differ(cursor, later);\n      highWater = cursor.plus({ [unit]: delta });\n\n      if (highWater > later) {\n        cursor = cursor.plus({ [unit]: delta - 1 });\n        delta -= 1;\n      } else {\n        cursor = highWater;\n      }\n\n      results[unit] = delta;\n    }\n  }\n\n  return [cursor, results, highWater, lowestOrder];\n}\n\nexport default function(earlier, later, units, opts) {\n  let [cursor, results, highWater, lowestOrder] = highOrderDiffs(earlier, later, units);\n\n  const remainingMillis = later - cursor;\n\n  const lowerOrderUnits = units.filter(\n    u => [\"hours\", \"minutes\", \"seconds\", \"milliseconds\"].indexOf(u) >= 0\n  );\n\n  if (lowerOrderUnits.length === 0) {\n    if (highWater < later) {\n      highWater = cursor.plus({ [lowestOrder]: 1 });\n    }\n\n    if (highWater !== cursor) {\n      results[lowestOrder] = (results[lowestOrder] || 0) + remainingMillis / (highWater - cursor);\n    }\n  }\n\n  const duration = Duration.fromObject(Object.assign(results, opts));\n\n  if (lowerOrderUnits.length > 0) {\n    return Duration.fromMillis(remainingMillis, opts)\n      .shiftTo(...lowerOrderUnits)\n      .plus(duration);\n  } else {\n    return duration;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}